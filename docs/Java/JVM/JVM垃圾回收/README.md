# JVM 垃圾回收

#### 1. 什么是垃圾回收？
垃圾回收（Garbage Collection，GC），
- 垃圾指的是程序运行过程中所产生的一些无用的对象，这些对象占用着一定的内存空间，如果长期不被释放，可能导致 OOM。
- 回收指的就是释放这些不再使用的对象占用的内存空间。


#### 2. 为什么需要 GC 这个功能？
- 首先要知道 GC 的主要作用是回收内存，而内存管理是编程人员很容易出现问题的地方，忘记或错误的内存回收会导致程序不稳定甚至崩溃，尤其是在使用 C++ 编程时。
- 其次从编程过程的角度来说，编程人员应该把更多的精力投入到更好的实现程序功能上，而不是耗费大量时间在内存管理上。

所以 Java 没有提供用来释放已分配内存的显式方法，而是通过 JVM 提供的 GC 功能来回收内存。


#### 3. 为什么我们要去了解 GC？
垃圾回收机制为我们处理了很多繁琐的工作，大大提高了开发的效率，但是垃圾回收也不是万能的。

- 一旦出现内存泄漏和溢出方面的问题，如果不了解 JVM 怎样管理内存的，那么排查错误将会是一个非常艰巨的任务。
- 当 GC 成为系统达到更高并发量的瓶颈时，我们就需要对 JVM GC 进行必要的监控和调节。

所以理解 JVM 内部的内存结构、工作机制，是诊断运行时问题和设计高扩展性应用的基础，也是 Java 工程师进阶的必备能力。


#### 4. 哪些内存需要有垃圾回收器管理？
在 JVM 运行时数据区域中，

- **程序计数器、Java 虚拟机栈、本地方法栈**，这 3 个区域随线程而创建、随线程而销毁。Java 虚拟机栈中的栈帧随着方法的进入和退出而有条不紊地执行着出栈和入栈的操作，每个栈帧中分配多少内存基本是在类结构确定下来时就已知的。所以这几个区域的内存分配和回收都具有确定性，就不需要过多考虑内存回收的问题。

- **Java 堆、方法区**，只有在程序处于运行时才能知道会创建哪些对象，并且在运行时可以加载类，所以这部分内存的分配和回收都是动态的，垃圾回收器主要关注这部分内存。


#### 5. 如何判断对象可以被回收？
对象存活判断