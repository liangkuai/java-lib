# Java 虚拟机栈

> ***线程私有***

Java 虚拟机栈（Java Virtual Machine Stack），早期也叫 Java 栈。生命周期与线程相同，每个线程在创建时都会创建一个虚拟机栈。


### 作用

**Java 虚拟机栈描述的是 Java 方法执行的内存模型**。每个 Java 方法在执行的同时都会创建一个**栈帧**（Stack Frame）。每一个 Java 方法从调用直到执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈到出栈的过程。


### 存储内容

Java 虚拟机栈内部存储一个个**栈帧**（Stack Frame），类似于数据结构中的栈，每一次函数调用都会有一个对应的栈帧被压入 Java 栈，每一个函数调用结束后，都会有一个栈帧被弹出。栈帧中又存储着局部变量表、操作数栈、动态链接、方法正常退出或者异常退出的定义等。

位于栈顶的栈帧称为当前栈帧，与当前栈帧关联的方法就是在程序计数器中提到的当前方法，当前方法所在的类叫做当前类。如果在当前方法中调用了其他方法，对应的新的栈帧会被创建出来，成为新的当前栈帧，一直到它返回结果或者执行结束。


### 可能出现的错误

#### 1. StackOverflowError

如果 Java 虚拟机栈的内存大小不允许动态扩展，那么当线程请求栈的深度超过当前 Java 虚拟机栈的最大深度的时候，就抛出 `StackOverflowError` 错误。

#### 2. OutOfMemoryError

如果 Java 虚拟机栈的内存大小允许动态扩展，且当线程请求栈时内存用完了，无法再动态扩展了，此时抛出 `OutOfMemoryError` 错误。