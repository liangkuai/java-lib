# 方法区

> ***线程共享***

方法区（Method Area），所有线程共享的一块内存区域。


### 存储内容

用于存储所谓的**元数据**，也就是已经被虚拟机加载的类相关信息，包括：
- 类结构信息，类的版本、字段、方法、接口和父类等信息
- 运行时常量池
- 字符串常量池


### JDK 1.8 前

#### 方法区与永久代

很多开发者都习惯将方法区称为永久代，其实这两者并不是等价的。

JVM 规范只是规定了有方法区这么个概念和它的作用，并没有规定如何去实现它。那么，在不同的 JVM 上方法区的实现肯定是不同的了。**HotSpot 虚拟机使用「永久代」来实现「方法区」**，在其它虚拟机中，例如，Oracle 的 JRockit、IBM 的 J9 就不存在永久代一说。


### JDK 1.8 开始

从 JDK 1.8 开始，HotSpot VM 移除了「永久代」，改用「***元空间***」（Metaspace）实现方法区。

> 为什么要将永久代 (PermGen) 替换为元空间 (MetaSpace) ?
>
> 1. 永久代设置大小有上限，而元空间使用直接内存，受宿主机可用内存的限制，虽然元空间也可能溢出，但是比原来的几率小。
> 2. JDK 1.8，HotSpot 合并 JRockit 的代码，而 JRockit 没有永久代。


#### 常用参数

```
//设置 Metaspace 的初始（和最小值）
-XX:MetaspaceSize=N

//设置 Metaspace 的最大值
-XX:MaxMetaspaceSize=N
```